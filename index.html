<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">
    <title>Cool MIDI looper!</title>

    <script src="./js/looper.js"></script>
</head>

<body>
    <h1>Cool MIDI looper!</h1>
    <select name="in-select" id="in-select">
        <option value="none">Select an input...</option>
    </select>
    <select name="out-select" id="out-select">
        <option value="none">Select an output...</option>
    </select>
    <br>
    <br>
    <input type="range" min="60" max="240" id="bpm" value="120" oninput="looper.SetBPM(this.value)">
    <label for="time" id="bpm-label">--</label>

    <p> <span id="beat">--</span> / <span id="measure">--</span> ... beatTime : <span id="beatTime">--</span></p>
    <p>
        <button id="rec-button" onclick="looper.ToggleRec()">Rec</button>
        <button id="clear-button" onclick="looper.ClearRec()">Clear</button>
    </p>
    <p>
        <button onclick="looper.Play();"  id="play-button">Play</button>
        <button onclick="looper.Pause();" id="pause-button">Pause</button>
        <button onclick="looper.Stop();"  id="stop-button">Stop</button>
    </p>
</body>
<script>
    const bpmSlider     = document.getElementById("bpm");
    const bpmLabel      = document.getElementById("bpm-label");
    const beatLabel     = document.getElementById("beat");
    const measureLabel  = document.getElementById("measure");
    const beatTimeLabel = document.getElementById("beatTime");

    const playButton  = document.getElementById("play-button" );
    const pauseButton = document.getElementById("pause-button");
    const stopButton  = document.getElementById("stop-button" );

    function SetSelectValues()
    {
        
    }

    function UpdateUI() {
        beatTimeLabel.innerHTML = looper.current.beatTime.toFixed(2);
        beatLabel.innerHTML = looper.current.beat % 4;
        measureLabel.innerHTML = looper.current.measure;
        
        bpmLabel.innerHTML = `${looper.bpm} (${looper.bpmInMs} ms)`;
        
        if(looper.isPlaying) {
            playButton.style.display  = "none";
            pauseButton.style.display = "inline-block";
        }
        else {
            playButton.style.display  = "inline-block";
            pauseButton.style.display = "none";
        }
    }

    looper.Init(null, UpdateUI);
    UpdateUI();
</script>

</html>